#!/usr/bin/env ruby

require "thor"
require "json"
require 'dotenv/load'
require 'active_support/all'
require_relative "../lib/entries_importer"

class Cli < Thor
  desc "import contentful_export_json_file.json", "Import contentful export JSON file"
  def import(file_name)
    unless File.exist?(file_name)
      puts "Error: File '#{file_name}' not found."
      exit(1)
    end

    begin
      json_data = JSON.parse(File.read(file_name))
      EntriesImporter.new("5duKiNPsR20mgISegMYmwK", "articles").run(json_data)

    rescue JSON::ParserError => e
      puts "Error parsing JSON: #{e.message}"
      exit(1)
    end
  end
end

Cli.start(ARGV)